category: Data Enrichment & Threat Intelligence
commonfields:
  id: VirusTotal - Premium API - V3
  version: -1
configuration:
- display: ""
  displaypassword: API Key
  name: credentials
  type: 9
  required: true
  hiddenusername: true
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Incident type
  name: incidentType
  required: false
  type: 13
- defaultvalue: '40'
  name: max_fetch
  required: false
  type: 0
- defaultvalue: 3 days
  display: First fetch timestamp (<number> <time unit>, e.g., 12 hours, 7 days) or a date or epoch timestamp.
  name: first_fetch
  required: false
  type: 0
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Analyze suspicious hashes, URLs, domains, and IP addresses
display: VirusTotal - Premium API - V3
name: VirusTotal - Premium API - V3
script:
  commands:
  - arguments:
    - default: true
      description: SHA-256, SHA-1 or MD5 identifying the file.
      isArray: false
      name: file
      required: true
      secret: false
    deprecated: false
    description: Downloads file from VirusTotal
    execution: false
    name: vt-premium-file-download
    outputs:
    - contextPath: File
      description: The file details command results.
      type: Unknown
    - contextPath: File.Name
      description: The full file name (including the file extension).
      type: String
    - contextPath: File.EntryID
      description: The ID for locating the file in the War Room.
      type: String
    - contextPath: File.Size
      description: The size of the file in bytes.
      type: Number
    - contextPath: File.MD5
      description: The MD5 hash of the file.
      type: String
    - contextPath: File.SHA1
      description: The SHA1 hash of the file.
      type: String
    - contextPath: File.SHA256
      description: The SHA256 hash of the file.
      type: String
    - contextPath: File.SHA512
      description: The SHA512 hash of the file.
      type: String
    - contextPath: File.Extension
      description: 'The file extension. For example: "xls".'
      type: String
    - contextPath: File.Type
      description: The file type, as determined by libmagic (same as displayed in
        file entries).
      type: String
  - arguments:
    - default: true
      description: A commma separated list of hashes (SHA-256, SHA-1, or MD5) for
        the files included in the ZIP.
      isArray: true
      name: files
      required: true
      secret: false
    - default: false
      description: A password to protect the zip.
      isArray: true
      name: password
      required: false
      secret: true
    deprecated: false
    description: Creates a password-protected ZIP file containing files from VirusTotal.
    execution: false
    name: vt-premium-zip-create
  - arguments:
    - default: true
      description: A zip ID. Can be retrieved from the output of vt-premium-zip-create.
      isArray: false
      name: zip_id
      required: true
      secret: false
    deprecated: false
    description: Retrieve information about a ZIP file.
    execution: false
    name: vt-premium-zip-get
  - arguments:
    - default: true
      description: A zip ID. Can be retrieved from the output of vt-premium-zip-create.
      isArray: false
      name: zip_id
      required: true
      secret: false
    deprecated: false
    description: Download a ZIP file.
    execution: false
    name: vt-premium-zip-download
  - arguments:
    - default: true
      description: Sandbox report ID. Can be aquired from vt-file-sandbox-report.
      isArray: false
      name: report_id
      required: true
      secret: false
    deprecated: false
    description: Extracted PCAP from a sandbox analysis.
    execution: false
    name: vt-premium-file-sandbox-pcap
  - arguments:
    - default: false
      description: Search query.
      isArray: false
      name: query
      required: true
      secret: false
    - default: false
      description: Maximum number of results.
      defaultValue: '10'
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      description: The order value can be sorted depends on the query type. See documentation.
      isArray: false
      name: order
      required: false
      secret: false
    - default: false
      description: Continuation cursor.
      isArray: false
      name: cursor
      required: false
      secret: false
    - default: false
      description: Whether to return full object information or just object descriptors.
      isArray: false
      name: descriptors_only
      defaultValue: 'false'
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      required: false
      secret: false
    deprecated: false
    description: Search for files.
    execution: false
    name: vt-premium-intelligence-search
  - arguments:
    - default: true
      description: Ruleset identifier.
      isArray: false
      name: id
      required: true
      secret: false
    deprecated: false
    description: Retrieve VT Hunting livehunt rulesets.
    execution: false
    name: vt-premium-livehunt-rules-get-by-id
  - arguments:
    - default: false
      description: Return the rulesets matching the given criteria only.
      isArray: false
      name: filter
      required: false
      secret: false
    - default: false
      description: Maximum number of results.
      defaultValue: '10'
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      description: Sort order.
      auto: PREDEFINED
      predefined:
      - "name-"
      - "creation_date-"
      - "modification_date-"
      - "name+"
      - "creation_date+"
      - "modification_date+"
      isArray: false
      name: order
      required: false
      secret: false
    - default: false
      description: Continuation cursor.
      isArray: false
      name: cursor
      required: false
      secret: false
    - default: false
      description: Should list only enabled or disabled rules.
      isArray: false
      name: enabled
      required: false
      secret: false
      defaultValue: "None"
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      - "None"
    description: Retrieve VT Hunting livehunt rulesets.
    execution: false
    name: vt-premium-livehunt-rules-list
  - arguments:
    - default: false
      description: Name of the rule.
      isArray: false
      name: name
      required: true
      secret: false
    - default: false
      description: The rule itself.
      isArray: false
      name: yara_rule
      required: true
      secret: false
    - default: false
      description: Whatever to enable the rule.
      isArray: false
      name: enabled
      required: false
      secret: false
      defaultValue: "false"
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
    - default: false
      description: A comma-separated list of emails to notify.
      isArray: false
      name: notification_emails
      required: false
      secret: false
    - default: false
      description: Limit of the rule.
      isArray: false
      name: limit
      required: true
      secret: false
    deprecated: false
    description: Create a new VT Hunting Livehunt ruleset.
    execution: false
    name: vt-premium-livehunt-rules-create
  - arguments:
    - default: true
      description: Rule identifier
      isArray: false
      name: id
      required: true
      secret: false
    - default: false
      description: The rule itself.
      isArray: false
      name: yara_rule
      required: false
      secret: false
    - default: false
      description: Whatever to enable the rule.
      isArray: false
      name: enabled
      required: false
      secret: false
      defaultValue: "false"
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
    - default: false
      description: A comma-separated list of emails to notify.
      isArray: false
      name: notification_emails
      required: false
      secret: false
    - default: false
      description: Limit of the rule.
      isArray: false
      name: limit
      required: false
      secret: false
    deprecated: false
    description: Update a VT Hunting Livehunt ruleset.
    execution: false
    name: vt-premium-livehunt-rules-update
  - arguments:
    - default: true
      description: Ruleset identifier
      isArray: false
      name: id
      required: true
      secret: false
    deprecated: false
    description: Delete a VT Hunting Livehunt ruleset.
    execution: false
    name: vt-premium-livehunt-rules-delete
  - arguments:
    - default: false
      description: Maximum number of notifications to retrieve. Maximum can be up
        to 40.
      defaultValue: "10"
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      description: Fetch notification from given time. Can be epoch time, a date or
        time range (3 days, 1 year)
      isArray: false
      name: from_time
      required: false
      secret: false
    - default: false
      description: Fetch notification from given time. Can be epoch time or a date.
      isArray: false
      name: to_time
      required: false
      secret: false
    - default: false
      description: Continuation cursor.
      isArray: false
      name: cursor
      required: false
      secret: false
    - default: false
      description: Filter notifications by tag.
      isArray: false
      name: tags
      required: false
      secret: false
    deprecated: false
    description: Retrieve VT Hunting Livehunt notifications.
    execution: false
    name: vt-premium-livehunt-notifications-list
  - arguments:
    - default: false
      description: String to search with in the hunting notification tags.
      isArray: false
      name: filter
      required: false
      secret: false
    - default: false
      description: Continuation cursor.
      isArray: false
      name: cursor
      required: false
      secret: false
    - default: false
      description: Maximum number of notifications to retrieve.
      isArray: false
      defaultValue: "10"
      name: limit
      required: false
      secret: false
    deprecated: false
    description: Retrieve file objects for VT Hunting Livehunt notifications.
    execution: false
    name: vt-premium-livehunt-notifications-files-list
  - arguments:
    - default: true
      description: Ruleset identifier
      isArray: false
      name: id
      required: true
      secret: false
    - default: false
      description: Continuation cursor.
      isArray: false
      name: cursor
      required: false
      secret: false
    - default: false
      description: Maximum number of notifications to retrieve.
      isArray: false
      defaultValue: "10"
      name: limit
      required: false
      secret: false
    deprecated: false
    description: Get a VT Hunting Livehunt ruleset by hunting notification files relationship.
    execution: false
    name: vt-premium-livehunt-rule-list-files
  - arguments:
    - default: false
      description: Return the jobs matching the given criteria only.
      isArray: false
      name: filter
      required: false
      secret: false
    - default: false
      description: Continuation cursor.
      isArray: false
      name: cursor
      required: false
      secret: false
    - default: false
      description: Maximum number jobs to retrieve.
      isArray: false
      defaultValue: "10"
      name: limit
      required: false
      secret: false
    deprecated: false
    description: Get a VT Hunting Livehunt ruleset by hunting notification files relationship.
    execution: false
    name: vt-premium-retrohunt-jobs-list
  - arguments:
    - default: true
      description: Job identifier
      isArray: false
      name: id
      required: true
      secret: false
    deprecated: false
    description: Retrieve a retrohunt job.
    execution: false
    name: vt-premium-retrohunt-jobs-get-by-id
  - arguments:
    - default: true
      description: Job identifier
      isArray: false
      name: id
      required: true
      secret: false
    deprecated: false
    description: Retrieve matches for a retrohunt job matching file relationship.
    execution: false
    name: vt-premium-retrohunt-jobs-get-matching-files
  - arguments:
    - default: false
      description: The rules to create.
      isArray: false
      name: rules
      required: true
      secret: false
    - default: false
      description: A comma-separated list of emails to notify.
      isArray: false
      name: notification_email
      required: false
      secret: false
    - default: false
      description: The "main" corpus is a composition of files sent to VirusTotal
        during the last few months. The "goodware" corpus is a random selection of
        ~1.000.000 files from the NSRL that are not detected by any antivirus engine.
      isArray: false
      name: corpus
      defaultValue: "main"
      auto: PREDEFINED
      predefined:
      - "main"
      - "goodware"
      required: false
      secret: false
    - default: false
      description: A comma-separated list of emails to notify.
      isArray: false
      name: notification_email
      required: false
      secret: false
    - default: false
      description: Fetch retrohunt jobs from given time. Can be epoch time, a date
        or time range (3 days, 1 year)
      isArray: false
      name: start_time
      required: false
      secret: false
    - default: false
      description: Fetch retrohunt jobs to given time. Can be epoch time, a date or
        time range. If start_time supplied and not end_time, end_time will be the
        current time.
      isArray: false
      name: end_time
      required: false
      secret: false
    deprecated: false
    description: Create a new retrohunt job.
    execution: false
    name: vt-premium-retrohunt-jobs-create
  - arguments:
    - default: true
      description: User ID or API key. If not supplied, will use the API Key configured
        in the integration.
      isArray: false
      name: id
      required: false
      secret: false
    deprecated: false
    description: Retrieve user's API usage.
    execution: false
    name: vt-premium-quota-limits-list
  isfetch: true
  runonce: false
  script: '-'
  type: python
  subtype: python3
  dockerimage: demisto/python3:3.9.2.17246
fromversion: 5.5.0
tests:
- No tests (auto formatted)
